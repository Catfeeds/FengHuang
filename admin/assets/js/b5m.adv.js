this.b5mshoppingassist||(this.b5mshoppingassist={}),function(a){var b=["jquery-highcharts","common","server"];a.define("adv",b,function(a,b,c){function d(){var c=null,d=null,e=null,f=(new Date).format("yyyy-MM-dd");try{var g=a.parseJSON(b5tplugin.getBrowserPopUrl());if(g)for(var h=g.newsdialog.content,i=0;i<h.length;i++)"browser"==h[i].displayPosition&&h[i].effectiveDateStr==f&&("js"==h[i].type?e=h[i]:d=h[i])}catch(j){}if(e){var k=e.showWebsite.replace(/\s/g,"");k||(k=".*");var k=new RegExp(k),l=b.getCookie("_n_p_ts");if(l||(l=0),l=parseInt(l),k.test(document.location.href)&&l<parseInt(e.showNum)){c=e;var m=(new Date).setHours(0,0,0,0)+864e5;b.setCookie("_n_p_ts",l+1,new Date(m).toUTCString())}}if(!c&&d){var n="";try{n=b.getCache("b5m_popAdv_date")}catch(j){}var o=!0;try{o=b5tplugin.isEnoughActiveDayNum()}catch(j){o=!0}var f=new Date,p=""+f.getFullYear()+f.getMonth()+f.getDate();if(o&&(!n||n!=p)){c=d;try{b.setCache("b5m_popAdv_date",p)}catch(j){}}}return c}var e={},f=0,g=function(b){function d(b,c){var d=b,f=c,g=parseInt(j.css("right")),h=parseInt(j.css("bottom"));a(document).bind("mousemove.adv",function(a){1==e.start&&(g-=a.screenX-d,h-=a.screenY-f,j.css({right:g+"px",bottom:h+"px"}),d=a.screenX,f=a.screenY)})}var g='<div id="b5m_popPanel_wrap"><div id="b5m_popPanel"><a class="b5m-close" href="javascript:void(0);"/><iframe frameborder="0" scrolling="no" allowtransparency="true" /></div></div>',h=null,i=document.createElement("link");i.rel="stylesheet",i.href=c.assets_base_url+"/css/default/b5m-plugin-adv.css",i.type="text/css",document.getElementsByTagName("head")[0].appendChild(i),h=a(g);var j=h.find("#b5m_popPanel");"image"==b.type?j.addClass("b5m-popPanel-image"):"text"==b.type?j.addClass("b5m-popPanel-text"):"js"==b.type&&j.addClass("b5m-popPanel-js"),"js"!=b.type&&j.css("background","url("+b.skinUrl+") no-repeat"),j.find("iframe")[0].src=b.sourceUrl,h.appendTo(a("body")),a("body").css("overflow","auto"),setTimeout(function(){h.show()},3e3),f=setTimeout(function(){h.animate({opacity:0},4e3,function(){a(this).remove()})},3e5),h.hover(function(){h.stop(),h.css("opacity","1"),hover=!0,clearTimeout(f)},function(){hover=!1,f=setTimeout(function(){h.animate({opacity:0},4e3,function(){a(this).remove()})},3e5)}),j.find(".b5m-close").bind("click",function(){h.css("display","none")}),j.bind("mousedown",function(b){return 2==b.button||3==b.button?(b.stopPropagation(),b.preventDefault(),!1):void(a(b.target).hasClass("b5m-close")||(e.start=1,d(b.screenX,b.screenY)))}).bind("mouseup",function(){e.start=0,a(document).unbind("mousemove.adv")}),a(document).bind("mouseup",function(){e.start=0,a(document).unbind("mousemove.adv")})};Date.prototype.format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a};var h={run:function(){var a=document.getElementById("b5tplugin");if(a&&!(a.version<"4.0.8")){var b=d();b&&g(b)}}};return h})}(this.b5mshoppingassist);